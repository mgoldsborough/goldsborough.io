---
import { Image } from "astro:assets";
import headshot from "../assets/images/mathew-goldsborough-headshot.png";

interface Props {
  currentPath: string;
}

const { currentPath } = Astro.props;
---

<nav class="navbar navbar-expand-lg bg-body-tertiary" transition:persist>
  <div class="container">
    <a class="navbar-brand" href="/">
      <Image
        class="rounded nav-avatar"
        src={headshot}
        alt="Mathew Goldsborough"
        width={30}
        height={30}
      />
      <span class="nav-brand-text">Mat Goldsborough</span>
    </a>

    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a
            class={`nav-link nav-link-animated${currentPath === "/" ? " active" : ""}`}
            href="/">Home</a
          >
        </li>
        <li class="nav-item">
          <a
            class={`nav-link nav-link-animated${currentPath === "/about" ? " active" : ""}`}
            href="/about">About</a
          >
        </li>
        <li class="nav-item">
          <a
            class={`nav-link nav-link-animated${currentPath === "/advisory" ? " active" : ""}`}
            href="/advisory">Advisory</a
          >
        </li>
        <li class="nav-item">
          <a
            class={`nav-link nav-link-animated${currentPath === "/speaking" ? " active" : ""}`}
            href="/speaking">Speaking</a
          >
        </li>

        <li class="nav-item d-none d-lg-block">
          <span class="nav-link nav-divider">|</span>
        </li>

        <!-- Icon links - grouped on mobile -->
        <li class="nav-item nav-icons">
          <div class="icon-group">
            <a
              class="nav-link icon-link"
              href="https://www.linkedin.com/in/goldsborough/"
              aria-label="LinkedIn"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                class="bi bi-linkedin"
                viewBox="0 0 16 16"
              >
                <path
                  d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"
                ></path>
              </svg>
            </a>
            <a class="nav-link icon-link" href="/rss.xml" aria-label="RSS Feed">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                class="bi bi-rss-fill"
                viewBox="0 0 16 16"
              >
                <path
                  d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm1.5 2.5c5.523 0 10 4.477 10 10a1 1 0 1 1-2 0 8 8 0 0 0-8-8 1 1 0 0 1 0-2zm0 4a6 6 0 0 1 6 6 1 1 0 1 1-2 0 4 4 0 0 0-4-4 1 1 0 0 1 0-2zm.5 7a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"
                ></path>
              </svg>
            </a>
            <a
              class="nav-link icon-link theme-toggle"
              href="#"
              id="lightDarkToggle"
              aria-label="Toggle theme"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                class="bi bi-moon-stars"
                viewBox="0 0 16 16"
              >
                <path
                  d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278zM4.858 1.311A7.269 7.269 0 0 0 1.025 7.71c0 4.02 3.279 7.276 7.319 7.276a7.316 7.316 0 0 0 5.205-2.162c-.337.042-.68.063-1.029.063-4.61 0-8.343-3.714-8.343-8.29 0-1.167.242-2.278.681-3.286z"
                ></path>
                <path
                  d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"
                ></path>
              </svg>
            </a>
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>

<style>
  /* Nav brand hover */
  .navbar-brand {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: opacity var(--transition-fast);
  }

  .navbar-brand:hover {
    opacity: 0.8;
  }

  .nav-avatar {
    transition: transform var(--transition-fast);
  }

  .navbar-brand:hover .nav-avatar {
    transform: scale(1.1) rotate(-5deg);
  }

  .nav-brand-text {
    font-weight: 500;
  }

  /* Animated nav links with underline */
  .nav-link-animated {
    position: relative;
    overflow: hidden;
  }

  .nav-link-animated::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 50%;
    width: 0;
    height: 2px;
    background: var(--accent-primary);
    transition:
      width var(--transition-base),
      left var(--transition-base);
  }

  .nav-link-animated:hover::after,
  .nav-link-animated.active::after {
    width: 100%;
    left: 0;
  }

  .nav-link-animated.active {
    color: var(--accent-primary) !important;
  }

  /* Icon links with scale effect */
  .icon-link {
    display: flex;
    align-items: center;
    justify-content: center;
    transition:
      transform var(--transition-fast),
      color var(--transition-fast);
  }

  .icon-link:hover {
    transform: scale(1.2);
    color: var(--accent-primary) !important;
  }

  .icon-link:active {
    transform: scale(0.95);
  }

  /* Theme toggle rotation */
  .theme-toggle svg {
    transition: transform var(--transition-base);
  }

  .theme-toggle:hover svg {
    transform: rotate(20deg);
  }

  /* Divider */
  .nav-divider {
    opacity: 0.3;
  }
</style>

<script>
  function updateActiveLink() {
    const currentPath = window.location.pathname.replace(/\/$/, "") || "/";
    const navLinks = document.querySelectorAll(".nav-link-animated");

    navLinks.forEach((link) => {
      const href = link.getAttribute("href")?.replace(/\/$/, "") || "/";
      link.classList.toggle("active", href === currentPath);
    });
  }

  // Update on initial load
  updateActiveLink();

  // Update after View Transitions navigation
  document.addEventListener("astro:page-load", updateActiveLink);
</script>

<style>
  /* Icon group - horizontal on all screens */
  .icon-group {
    display: flex;
    align-items: center;
    gap: 0.25rem;
  }

  /* Mobile menu styling */
  @media (max-width: 991.98px) {
    .navbar-collapse {
      padding: 1rem 0;
      border-top: 1px solid var(--border);
      margin-top: 0.5rem;
    }

    .navbar-nav {
      gap: 0.25rem;
    }

    .nav-link-animated {
      padding: 0.75rem 0;
    }

    .nav-icons {
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border);
    }

    .icon-group {
      gap: 1rem;
    }
  }
</style>
